{% schema %}
{
  "name": "Smart Offer Button",
  "target": "section",
  "stylesheet": "offer.css",
  "javascript": "offer.js",
  "settings": [
    { "type": "text", "id": "btn_text", "label": "Texte du bouton", "default": "Faire une offre" },
    { "type": "range", "id": "btn_height", "min": 30, "max": 100, "step": 1, "unit": "px", "label": "Hauteur", "default": 44 }
  ]
}
{% endschema %}

<div class="smart-offer-container product-form__buttons">
  <button id="smart-offer-trigger" class="button button--secondary product-form__submit" style="width: 100%; min-height: {{ block.settings.btn_height }}px; cursor: pointer; display: flex; align-items: center; justify-content: center;">
    {{ block.settings.btn_text }}
  </button>

  <div id="smart-offer-modal" class="smart-offer-modal" style="display: none;">
    <div class="smart-offer-modal-content">
      <span class="smart-offer-close">&times;</span>
      <h3>Négocier le prix</h3>
      <div id="smart-offer-step-1">
          <p>Quel est votre meilleur prix ?</p>
          <input type="number" id="smart-offer-input" placeholder="Prix (€)" />
          <button id="smart-offer-submit">Envoyer l'offre</button>
      </div>
      <div id="smart-offer-feedback"></div>
    </div>
  </div>
</div>

<script>
  window.smartOfferConfig = {
    productId: "{{ product.id }}",
    variantId: "{{ product.selected_or_first_available_variant.id }}",
    shopUrl: "{{ shop.permanent_domain }}"
  };
</script>
